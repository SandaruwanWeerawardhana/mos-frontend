
let items = [
  {
    itemCode: "B1001",
    itemName: "Classic Burger",
    price: 750.0,
    discount: 0,
    img: "https://images.pexels.com/photos/5554607/pexels-photo-5554607.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1002",
    itemName: "Classic Burger",
    price: 1500.0,
    discount: 15,
    img: "https://images.pexels.com/photos/1556698/pexels-photo-1556698.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1003",
    itemName: "Turkey Burger",
    price: 1600.0,
    discount: 0,
    img: "https://images.pexels.com/photos/3738730/pexels-photo-3738730.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1004",
    itemName: "Chicken Burger",
    price: 1400.0,
    discount: 0,
    img: "https://images.pexels.com/photos/15832879/pexels-photo-15832879/free-photo-of-cheeseburger-with-french-fries-and-three-dipping-sauces.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1005",
    itemName: "Chicken Burger",
    price: 800.0,
    discount: 20,
    img: "https://images.pexels.com/photos/552056/pexels-photo-552056.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1006",
    itemName: "Cheese Burger",
    price: 1000.0,
    discount: 0,
    img: "https://images.pexels.com/photos/13163534/pexels-photo-13163534.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1007",
    itemName: "Cheese Burger",
    price: 600.0,
    discount: 0,
    img: "https://images.pexels.com/photos/580612/pexels-photo-580612.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1008",
    itemName: "Bacon Burger",
    price: 650.0,
    discount: 15,
    img: "https://images.pexels.com/photos/15146310/pexels-photo-15146310/free-photo-of-burgere-on-plate.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1009",
    itemName: "Shawarma Burger",
    price: 800.0,
    discount: 0,
    img: "https://images.pexels.com/photos/18188571/pexels-photo-18188571/free-photo-of-burger-and-a-shawarma.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1010",
    itemName: "Olive Burger",
    price: 1800.0,
    discount: 0,
    img: "https://images.pexels.com/photos/11401287/pexels-photo-11401287.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1012",
    itemName: "Cheese Burger",
    price: 1250.0,
    discount: 20,
    img: "https://images.pexels.com/photos/10922927/pexels-photo-10922927.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1013",
    itemName: "Crispy Burger",
    price: 1200.0,
    discount: 0,
    img: "https://images.pexels.com/photos/6896379/pexels-photo-6896379.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1014",
    itemName: "Chicken Burger",
    price: 1600.0,
    discount: 10,
    img: "https://images.pexels.com/photos/5474640/pexels-photo-5474640.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1015",
    itemName: "Paneer Burger",
    price: 900.0,
    discount: 0,
    img: "https://images.pexels.com/photos/1556688/pexels-photo-1556688.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1",
  },
  {
    itemCode: "B1044",
    itemName: "Pepsi",
    price: 990.0,
    discount: 5,
    img: "https://www.ocado.com/productImages/612/612029011_1_640x640.jpg?identifier=03aff14ac20f6f9db3749cf29dd865b7",
  },
  {
    itemCode: "B1045",
    itemName: "Coca-Cola",
    price: 1230.0,
    discount: 0,
    img: "https://i.pinimg.com/originals/99/af/9c/99af9cd03aaf6a856fdfea9d27802f24.jpg",
  },
  {
    itemCode: "B1046",
    itemName: "Sprite",
    price: 1500.0,
    discount: 3,
    img: "https://i.pinimg.com/736x/da/29/54/da29549b7fd367669b7d8502d9d0028c.jpg",
  },
  {
    itemCode: "B1047",
    itemName: "Mirinda",
    price: 850.0,
    discount: 7,
    img: "https://i.pinimg.com/736x/99/0b/46/990b466538fbdc1f4b6722a6a393e908.jpg",
  },
  {
    itemCode: "B1038",
    itemName: "Fried Chicken",
    price: 1200.0,
    discount: 0,
    img: "https://christieathome.com/wp-content/uploads/2020/10/Facetune_06-10-2020-15-37-58-scaled.jpg",
  },
  {
    itemCode: "B1039",
    itemName: "Fried Chicken",
    price: 2300.0,
    discount: 10,
    img: "https://www.therusticelk.com/wp-content/uploads/2018/09/Southern-fried-chicken-2.jpg",
  },
  {
    itemCode: "B1040",
    itemName: "Fried Chicken",
    price: 3100.0,
    discount: 5,
    img: "https://airfryermom.com/wp-content/uploads/2022/05/Cook-Fried-Chicken-in-Air-Fryer.jpg",
  },
  {
    itemCode: "B1041",
    itemName: "Hot Wings",
    price: 2400.0,
    discount: 0,
    img: "https://www.browneyedbaker.com/wp-content/uploads/2020/12/buttermilk-fried-chicken-12-square.jpg",
  },
  {
    itemCode: "B1042",
    itemName: "Devilled Chicken",
    price: 900.0,
    discount: 0,
    img: "https://foodserviceindia.com/wp-content/uploads/2023/07/Frame-65.jpg",
  },
  {
    itemCode: "B1043",
    itemName: "BBQ Chicken",
    price: 2100.0,
    discount: 0,
    img: "https://poshjournal.com/wp-content/uploads/2021/02/thai-bbq-chicken-wings-8.jpg",
  },
];
document
  .getElementById("itemForm")
  .addEventListener("submit", function (event) {
    event.preventDefault();
    OderPlace();
  });

// View Items

let tblBody = document.getElementById("OderBody");
let body = ``;
items.forEach((element, index) => {
  body += `
        <tr>
          <td>${element.itemCode}</td>
          <td>${element.itemName}</td>
        
          <td>Rs.${element.price}</td>
          <td><img src="${element.img}" alt="${element.itemName}" class="item-image" style="height: 50px;"></td>
          <td>
        <button class="btn btn-sm btn-outline-primary" onclick="addCart(${index})">Add Cart</button>
             
              </td>
              </tr>    
    `;
});
tblBody.innerHTML = body;

// add cart
let CartArray = [];

function addCart(index) {
  const selectItem = items[index];
  const existingItem = CartArray.find(
    (item) => item.Code === selectItem.itemCode
  );

  if (existingItem) {
    existingItem.qty += 1;
  } else {
    CartArray.push({
      Code: selectItem.itemCode,
      Name: selectItem.itemName,
      Price: selectItem.price,
      img: selectItem.img,
      qty: 1,
    });
  }

  displayCart();
}

// Display Cart
function displayCart() {
  const AddCart = document.getElementById("cartboxId");
  let TempAddCart = ``;

  CartArray.forEach((element, index) => {
    TempAddCart += `
      <tr>
        <td>${element.Code}</td>
        <td>${element.Name}</td>
        <td>Rs.${element.Price}</td>
        <td><img src="${element.img}" alt="${element.Name}" class="item-image" style="width: 50px; height: auto;"></td>
        <td>${element.qty}</td>
        <td>
          <button class="btn btn-sm btn-outline-danger" onclick="removeCartItem(${index})">üóëÔ∏è</button>
        </td>
      </tr>
    `;
  });

  AddCart.innerHTML = TempAddCart;
}

// Remove  Cart
function removeCartItem(index) {
  CartArray.splice(index, 1);
  displayCart();
}

// oder place

let Oderarray = [];

function OderPlace() {
  const name = document.getElementById("name").value;
  const number = document.getElementById("contact").value;
  const discount = parseFloat(document.getElementById("discount").value || 0);

  if (!name || !number || isNaN(discount)) {
    alert("Please fill out all fields correctly.");
    return;
  }

  let total = 0;
  CartArray.forEach((item) => {
    total += item.Price * item.qty;
  });

  const discountedTotal =discount !== 0 ? total - total * (discount / 100) : total;

  Oderarray.push({
    Name: name,
    Number: number,
    Items: CartArray,
    Discount: discount,
    Total: discountedTotal,
  });

  let tableInner = document.getElementById("PlacedTable");
  tableInner.innerHTML = "";

  Oderarray.forEach((order) => {
    let row = document.createElement("tr");

    let nameCell = document.createElement("td");
    nameCell.textContent = order.Name;
    row.appendChild(nameCell);

    let numberCell = document.createElement("td");
    numberCell.textContent = order.Number;
    row.appendChild(numberCell);

    let itemNameCell = document.createElement("td");
    order.Items.forEach((item) => {
      let itemName = document.createElement("h6");
      itemName.textContent = item.Name;
      itemNameCell.appendChild(itemName);
    });
    row.appendChild(itemNameCell);

    let qtyCell = document.createElement("td");
    order.Items.forEach((item) => {
      let qty = document.createElement("h6");
      qty.textContent = item.qty;
      qtyCell.appendChild(qty);
    });
    row.appendChild(qtyCell);

    let priceCell = document.createElement("td");
    order.Items.forEach((item) => {
      let price = document.createElement("h6");
      price.textContent = item.Price;
      priceCell.appendChild(price);
    });
    row.appendChild(priceCell);

    let discountCell = document.createElement("td");
    discountCell.textContent = order.Discount;
    row.appendChild(discountCell);

    let totalCell = document.createElement("td");
    totalCell.textContent = order.Total;
    row.appendChild(totalCell);

    let actionCell = document.createElement("td");
    let printButton = document.createElement("button");
    printButton.textContent = "Print Bill";
    printButton.className = "btn btn-sm btn btn-outline-primary";
    printButton.onclick = () => printBill(order); // Attach the function call
    actionCell.appendChild(printButton);
    row.appendChild(actionCell);

    tableInner.appendChild(row);
  });

  // Clear the cart
  CartArray = [];
  displayCart();

  // Reset the form fields
  document.getElementById("name").value = "";
  document.getElementById("contact").value = "";
  document.getElementById("discount").value = "";

  alert("Order placed successfully!");
}

// Search the table 
let searchInput = document.getElementById("searchInput");
searchInput.addEventListener("keyup", search);

function search(){
  const query = searchInput.value.toLowerCase();
  const filteredItems = items.filter((item) =>
    item.itemName.toLowerCase().includes(query) 
  );

  let body = ``;
  filteredItems.forEach((element, index) => {
    body += `
      <tr>
        <td>${element.itemCode}</td>
        <td>${element.itemName}</td>
        <td>Rs.${element.price}</td>
        <td><img src="${element.img}" alt="${element.itemName}" class="item-image" style="height: 50px;"></td>
        <td>
          <button class="btn btn-sm btn-outline-primary" onclick="addCart(${index})">Add Cart</button>
        </td>
      </tr>
    `;
  });

  tblBody.innerHTML = body;
}
// print bill

function printBill(order) {
  let invoiceWindow = window.open("", "_blank");
  let invoiceContent = `
    <html>
    <head>
      <title>Invoice</title>
      <style>
        body {
          font-family: Arial, sans-serif;
          margin: 20px;
          line-height: 1.6;
        }
        h1, h3, h4 {
          text-align: center;
        }
        table {
          width: 100%;
          border-collapse: collapse;
          margin: 20px 0;
        }
        table, th, td {
          border: 1px solid black;
        }
        th, td {
          padding: 10px;
          text-align: left;
        }
        .total {
          text-align: right;
        }
        .footer {
          margin-top: 20px;
          text-align: center;
        }
      </style>
    </head>
    <body style="background-color: rgb(114, 117, 181)">
    <div class="text-center justify-content-around"><img src="Asset/LogoBg remove.png" alt="" srcset=""></div>
      <h3>Details</h3>
      <p><strong>Name:</strong> ${order.Name}</p>
      <p><strong>Contact:</strong> ${order.Number}</p>

      <h3>Order Details</h3>
      <table>
        <thead>
          <tr>
            <th>Item Name</th>
            <th>Quantity</th>
            <th>Unit Price (Rs.)</th>
            <th>Total (Rs.)</th>
          </tr>
        </thead>
        <tbody>
          ${order.Items.map(
            (item) => `
            <tr>
              <td>${item.Name}</td>
              <td>${item.qty}</td>
              <td>${item.Price.toFixed(2)}</td>
              <td>${(item.Price * item.qty).toFixed(2)}</td>
            </tr>
          `
          ).join("")}
        </tbody>
      </table>
      <p class="total"><strong>Discount:</strong> ${order.Discount}%</p>
      <p class="total"><strong>Grand Total:</strong> Rs.${order.Total.toFixed(
        2
      )}</p>

      <div class="footer">
        <h4>Thank you for your purchase!</h4>
        <p>We hope to serve you again soon.</p>
      </div>
    </body>
    </html>
  `;

  invoiceWindow.document.write(invoiceContent);
  invoiceWindow.document.close();
  invoiceWindow.print();
}
